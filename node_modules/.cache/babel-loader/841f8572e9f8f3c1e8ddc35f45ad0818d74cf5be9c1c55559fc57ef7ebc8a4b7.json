{"ast":null,"code":"var _jsxFileName = \"/home/kokoi/sol-wager-app/frontend/src/App.jsx\",\n  _s = $RefreshSig$();\n// src/App.jsx\n\nimport React, { useState, useEffect, useRef } from \"react\";\nimport \"./App.css\";\nimport sentences from \"./sentences\";\nimport { useConnection, useWallet } from \"@solana/wallet-adapter-react\";\nimport { WalletMultiButton } from \"@solana/wallet-adapter-react-ui\";\nimport { LAMPORTS_PER_SOL, PublicKey, SystemProgram, Transaction } from \"@solana/web3.js\";\nimport socket from \"./socket\";\nimport * as anchor from \"@coral-xyz/anchor\";\nimport idl from \"./idl/typeracer_escrow.json\";\n\n// Program ID from IDL\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst PROGRAM_ID = new PublicKey(idl.metadata.address);\nexport default function App() {\n  _s();\n  const {\n    connection\n  } = useConnection();\n  const wallet = useWallet();\n  const {\n    publicKey,\n    connected\n  } = wallet;\n  const walletAddress = (publicKey === null || publicKey === void 0 ? void 0 : publicKey.toBase58()) || \"\";\n\n  // Anchor provider setup\n  const providerRef = useRef(null);\n  useEffect(() => {\n    if (connected && connection) {\n      const prov = new anchor.AnchorProvider(connection, wallet, {\n        preflightCommitment: \"confirmed\"\n      });\n      anchor.setProvider(prov);\n      providerRef.current = prov;\n    }\n  }, [connected, connection, wallet]);\n\n  // Helper to get your Anchor Program\n  const getProgram = () => {\n    const prov = providerRef.current;\n    if (!prov) throw new Error(\"Provider not ready\");\n    return new anchor.Program(idl, PROGRAM_ID, prov);\n  };\n\n  // Wallet balance\n  const [walletBalance, setWalletBalance] = useState(0);\n  useEffect(() => {\n    if (connection && publicKey) {\n      connection.getBalance(publicKey).then(lamports => {\n        setWalletBalance(lamports / LAMPORTS_PER_SOL);\n      });\n    }\n  }, [connection, publicKey]);\n\n  // Game & race state\n  const [wager, setWager] = useState(1);\n  const [openMatches, setOpenMatches] = useState([]);\n  const [currentMatch, setCurrentMatch] = useState(null);\n  const [matchStatus, setMatchStatus] = useState(\"waiting\");\n  const [sentence, setSentence] = useState(\"\");\n  const [inputValue, setInputValue] = useState(\"\");\n  const [playerProgress, setPlayerProgress] = useState(0);\n  const [opponentProgress, setOpponentProgress] = useState(0);\n  const [countdown, setCountdown] = useState(3);\n  const [raceResult, setRaceResult] = useState(null);\n  const [isInputDisabled, setIsInputDisabled] = useState(false);\n  const [isAccepting, setIsAccepting] = useState(false);\n  const [opponentWallet, setOpponentWallet] = useState(null);\n\n  // Chat\n  const [chatMessages, setChatMessages] = useState([]);\n  const [chatInput, setChatInput] = useState(\"\");\n\n  // Anti-cheat\n  const [lastProgTime, setLastProgTime] = useState(Date.now());\n  const [lastProg, setLastProg] = useState(0);\n  const MAX_CPS = 20;\n  const inputRef = useRef(null);\n  const API = process.env.REACT_APP_API_URL;\n\n  // Socket listeners\n  useEffect(() => {\n    socket.connect();\n    socket.on(\"openMatches\", setOpenMatches);\n    socket.on(\"newMatch\", m => setOpenMatches(os => [...os, m]));\n    socket.on(\"removeMatch\", id => setOpenMatches(os => os.filter(m => m.id !== id)));\n    socket.on(\"startMatch\", ({\n      id,\n      players\n    }) => {\n      if ((currentMatch === null || currentMatch === void 0 ? void 0 : currentMatch.id) === id) {\n        setMatchStatus(\"ready\");\n        setSentence(chooseSentence(id));\n        setCountdown(3);\n        setOpponentWallet(players.find(w => w !== walletAddress));\n      }\n    });\n    socket.on(\"opponentProgress\", ({\n      wallet: w,\n      progress\n    }) => {\n      if (w !== walletAddress) setOpponentProgress(progress);\n    });\n    socket.on(\"raceEnd\", ({\n      winner,\n      progressMap\n    }) => {\n      setMatchStatus(\"finished\");\n      setIsInputDisabled(true);\n      setRaceResult({\n        result: winner === walletAddress ? \"win\" : \"lose\"\n      });\n      if (progressMap) {\n        var _progressMap$walletAd, _progressMap$opponent;\n        setPlayerProgress((_progressMap$walletAd = progressMap[walletAddress]) !== null && _progressMap$walletAd !== void 0 ? _progressMap$walletAd : 0);\n        setOpponentProgress((_progressMap$opponent = progressMap[opponentWallet]) !== null && _progressMap$opponent !== void 0 ? _progressMap$opponent : 0);\n      }\n    });\n    socket.on(\"chat\", setChatMessages);\n    socket.on(\"opponentLeft\", async () => {\n      if (matchStatus === \"finished\" && (raceResult === null || raceResult === void 0 ? void 0 : raceResult.result) === \"win\" && currentMatch !== null && currentMatch !== void 0 && currentMatch.id) {\n        try {\n          await resolve(currentMatch.id, publicKey);\n        } catch (e) {\n          console.error(\"Auto‚Äëclaim failed:\", e);\n        }\n      }\n      resetGame();\n    });\n    return () => socket.removeAllListeners();\n  }, [currentMatch, walletAddress, opponentWallet, matchStatus, raceResult, publicKey]);\n\n  // Countdown\n  useEffect(() => {\n    if (matchStatus === \"ready\" && countdown > 0) {\n      const t = setTimeout(() => setCountdown(c => c - 1), 1000);\n      return () => clearTimeout(t);\n    } else if (matchStatus === \"ready\" && countdown === 0) {\n      var _inputRef$current;\n      setMatchStatus(\"racing\");\n      setIsInputDisabled(false);\n      (_inputRef$current = inputRef.current) === null || _inputRef$current === void 0 ? void 0 : _inputRef$current.focus();\n    }\n  }, [countdown, matchStatus]);\n\n  // Helpers\n  const chooseSentence = id => sentences[Array.from(id).reduce((a, c) => a + c.charCodeAt(0), 0) % sentences.length];\n  const fetchOpenMatches = async () => {\n    try {\n      const res = await fetch(`${API}/wagers`);\n      setOpenMatches(await res.json());\n    } catch {}\n  };\n  const resetGame = () => {\n    setCurrentMatch(null);\n    setMatchStatus(\"waiting\");\n    setSentence(\"\");\n    setInputValue(\"\");\n    setPlayerProgress(0);\n    setOpponentProgress(0);\n    setCountdown(3);\n    setRaceResult(null);\n    setIsInputDisabled(false);\n    setOpponentWallet(null);\n    setLastProg(0);\n    setLastProgTime(Date.now());\n    fetchOpenMatches();\n  };\n\n  // createMatch\n  async function createMatch() {\n    if (!connected) return alert(\"Connect wallet\");\n    const provider = providerRef.current;\n    if (!provider) return alert(\"Provider not ready\");\n    const lamports = Math.floor(wager * LAMPORTS_PER_SOL);\n    const program = getProgram();\n    const nonce = Math.floor(Math.random() * 1000000);\n    const [escrowPda] = await PublicKey.findProgramAddress([Buffer.from(\"escrow\"), provider.wallet.publicKey.toBuffer(), new anchor.BN(nonce).toArrayLike(Buffer, \"le\", 8)], program.programId);\n    const ixInit = await program.methods.initialize(new anchor.BN(lamports), new anchor.BN(nonce)).accounts({\n      escrow: escrowPda,\n      player1: provider.wallet.publicKey,\n      authority: provider.wallet.publicKey,\n      systemProgram: SystemProgram.programId\n    }).instruction();\n    const ixDeposit = await program.methods.deposit().accounts({\n      escrow: escrowPda,\n      payer: provider.wallet.publicKey,\n      escrowAccount: escrowPda,\n      systemProgram: SystemProgram.programId\n    }).instruction();\n    const tx = new Transaction().add(ixInit, ixDeposit);\n    tx.feePayer = provider.wallet.publicKey;\n    const {\n      blockhash,\n      lastValidBlockHeight\n    } = await provider.connection.getLatestBlockhash(\"confirmed\");\n    tx.recentBlockhash = blockhash;\n    let signed;\n    try {\n      signed = await provider.wallet.signTransaction(tx);\n    } catch (err) {\n      return alert(\"Signing failed: \" + err.message);\n    }\n    try {\n      const sig = await provider.connection.sendRawTransaction(signed.serialize(), {\n        skipPreflight: false,\n        preflightCommitment: \"confirmed\"\n      });\n      await provider.connection.confirmTransaction({\n        signature: sig,\n        blockhash,\n        lastValidBlockHeight\n      }, \"confirmed\");\n    } catch (err) {\n      console.error(\"createMatch failed:\", err);\n      return alert(`Failed to create match:\\n${err.message || err}`);\n    }\n    const id = escrowPda.toBase58();\n    await fetch(`${API}/wagers`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        id,\n        amount: Number(wager),\n        creator: walletAddress,\n        feePercent: 5\n      })\n    });\n    setCurrentMatch({\n      id,\n      amount: Number(wager),\n      creator: walletAddress\n    });\n    socket.emit(\"joinMatch\", id);\n    setMatchStatus(\"waiting\");\n  }\n\n  // acceptMatch\n  async function acceptMatch(m) {\n    if (!connected) return alert(\"Connect wallet\");\n    setIsAccepting(true);\n    const program = getProgram();\n    try {\n      await program.methods.joinAndDeposit().accounts({\n        escrow: new PublicKey(m.id),\n        player2: providerRef.current.wallet.publicKey,\n        escrowAccount: new PublicKey(m.id),\n        systemProgram: SystemProgram.programId\n      }).rpc();\n      await fetch(`${API}/wagers/${m.id}/accept`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          accepter: walletAddress\n        })\n      });\n      setCurrentMatch({\n        ...m,\n        accepter: walletAddress\n      });\n      setMatchStatus(\"ready\");\n      setCountdown(3);\n      socket.emit(\"joinMatch\", m.id);\n    } catch (e) {\n      console.error(\"acceptMatch failed:\", e);\n      alert(`Failed to accept match:\\n${e.message || e}`);\n      setCurrentMatch(null);\n    } finally {\n      setIsAccepting(false);\n    }\n  }\n\n  // cancelMatch\n  async function cancelMatch(m) {\n    const program = getProgram();\n    try {\n      await program.methods.cancel().accounts({\n        escrow: new PublicKey(m.id),\n        player1: new PublicKey(m.creator),\n        player2: new PublicKey(m.accepter || m.creator),\n        escrowAccount: new PublicKey(m.id),\n        authority: providerRef.current.wallet.publicKey\n      }).rpc();\n      await fetch(`${API}/wagers/${m.id}/cancel`, {\n        method: \"POST\"\n      });\n      resetGame();\n    } catch (e) {\n      console.error(\"cancelMatch failed:\", e);\n      alert(`Failed to cancel match:\\n${e.message || e}`);\n    }\n  }\n\n  // resolve (claim)\n  async function resolve(id, winnerPubkey) {\n    const program = getProgram();\n    try {\n      const escrowPda = new PublicKey(id);\n      const escrowState = await program.account.escrow.fetch(escrowPda);\n      const vaultPda = new PublicKey(escrowState.escrowAccount);\n      const sig = await program.methods.resolve(winnerPubkey).accounts({\n        escrow: escrowPda,\n        winner: winnerPubkey,\n        house: providerRef.current.wallet.publicKey,\n        escrowAccount: vaultPda,\n        authority: providerRef.current.wallet.publicKey\n      }).rpc();\n      return sig;\n    } catch (err) {\n      console.error(\"resolve failed:\", err);\n      throw err;\n    }\n  }\n\n  // handleInput\n  function handleInput(e) {\n    if (isInputDisabled) return;\n    if (e.type === \"paste\") {\n      e.preventDefault();\n      return;\n    }\n    const now = Date.now();\n    const val = e.target.value;\n    const rawProg = Math.min(1, val.length / sentence.length);\n    const deltaProg = rawProg - lastProg;\n    const deltaTime = (now - lastProgTime) / 1000;\n    const chars = deltaProg * sentence.length;\n    const cps = deltaTime > 0 ? chars / deltaTime : 0;\n    if (cps > MAX_CPS) return;\n    setLastProg(rawProg);\n    setLastProgTime(now);\n    setInputValue(val);\n    setPlayerProgress(rawProg);\n    socket.emit(\"progress\", {\n      matchId: currentMatch.id,\n      wallet: walletAddress,\n      progress: rawProg\n    });\n    if (val === sentence) {\n      fetch(`${API}/wagers/${currentMatch.id}/complete`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          winner: walletAddress\n        })\n      });\n      setMatchStatus(\"finished\");\n      setIsInputDisabled(true);\n      setRaceResult({\n        result: \"win\"\n      });\n    }\n  }\n\n  // renderMatchmaking\n  const renderMatchmaking = () => /*#__PURE__*/_jsxDEV(\"section\", {\n    className: \"matchmaking\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Create a Match\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 378,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      children: [\"Wager (SOL):\", /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"number\",\n        min: \"0.01\",\n        step: \"0.01\",\n        value: wager,\n        onChange: e => setWager(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 381,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 379,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: createMatch,\n      disabled: !wager || wager <= 0,\n      children: \"Create Match\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 389,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      style: {\n        marginTop: 20\n      },\n      children: \"Open Matches\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 392,\n      columnNumber: 7\n    }, this), openMatches.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"No open matches. Create one!\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 394,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"ul\", {\n      children: openMatches.map(m => /*#__PURE__*/_jsxDEV(\"li\", {\n        children: [m.id.slice(0, 6), \"\\u2026 | \", m.amount, \" SOL\", \" \", m.creator === walletAddress ? /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => cancelMatch(m),\n          style: {\n            marginLeft: 10\n          },\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 401,\n          columnNumber: 17\n        }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => acceptMatch(m),\n          disabled: !!currentMatch || isAccepting,\n          style: {\n            marginLeft: 10\n          },\n          children: isAccepting ? \"Accepting‚Ä¶\" : \"Accept\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 405,\n          columnNumber: 17\n        }, this)]\n      }, m.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 398,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 396,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 377,\n    columnNumber: 5\n  }, this);\n\n  // renderWaiting\n  const renderWaiting = () => /*#__PURE__*/_jsxDEV(\"section\", {\n    className: \"waiting-section\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Waiting for opponent\\u2026\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 423,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => cancelMatch(currentMatch),\n      children: \"Cancel Match\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 424,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 422,\n    columnNumber: 5\n  }, this);\n\n  // renderRace\n  const renderRace = () => /*#__PURE__*/_jsxDEV(\"section\", {\n    className: \"race-section\",\n    children: [matchStatus === \"ready\" && /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: [\"Starting in \", countdown]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 431,\n      columnNumber: 35\n    }, this), matchStatus === \"racing\" && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sentence-display\",\n        children: sentence\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 434,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        ref: inputRef,\n        type: \"text\",\n        value: inputValue,\n        onChange: handleInput,\n        onPaste: handleInput,\n        placeholder: \"Start typing\\u2026\",\n        disabled: isInputDisabled,\n        autoFocus: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 435,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"track\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lane\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"car car-player\",\n            style: {\n              left: `${playerProgress * 100}%`\n            },\n            children: \"\\uD83D\\uDE97\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 447,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 446,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lane\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"car car-opponent\",\n            style: {\n              left: `${opponentProgress * 100}%`\n            },\n            children: \"\\uD83C\\uDFCE\\uFE0F\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 455,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 454,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 445,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true), matchStatus === \"finished\" && (raceResult === null || raceResult === void 0 ? void 0 : raceResult.result) === \"win\" && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"results results-win\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        style: {\n          fontSize: \"2rem\"\n        },\n        children: \"\\uD83C\\uDFC6 You Won!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 467,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: async () => {\n          try {\n            await resolve(currentMatch.id, publicKey);\n            resetGame();\n          } catch (e) {\n            console.error(e);\n            alert(\"Payout error: \" + (e.message || e));\n          }\n        },\n        children: \"Claim Winnings\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 468,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 466,\n      columnNumber: 9\n    }, this), matchStatus === \"finished\" && (raceResult === null || raceResult === void 0 ? void 0 : raceResult.result) === \"lose\" && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"results results-lose\",\n      style: {\n        textAlign: \"center\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        style: {\n          fontSize: \"2rem\",\n          color: \"#c0392b\"\n        },\n        children: \"\\uD83D\\uDE22 You Lost!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 485,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Better luck next time!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 486,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: resetGame,\n        children: \"Back to Matches\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 487,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 484,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 430,\n    columnNumber: 5\n  }, this);\n\n  // renderChat\n  const renderChat = () => /*#__PURE__*/_jsxDEV(\"section\", {\n    className: \"chat-section\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Chat\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 496,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-messages\",\n      style: {\n        maxHeight: 150,\n        overflowY: \"auto\"\n      },\n      children: chatMessages.map((msg, i) => /*#__PURE__*/_jsxDEV(\"p\", {\n        className: msg.sender === walletAddress ? \"self\" : \"other\",\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: [msg.sender.slice(0, 6), \"\\u2026:\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 500,\n          columnNumber: 13\n        }, this), \" \", msg.message]\n      }, i, true, {\n        fileName: _jsxFileName,\n        lineNumber: 499,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 497,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      value: chatInput,\n      onChange: e => setChatInput(e.target.value),\n      onKeyDown: e => e.key === \"Enter\" && socket.emit(\"message\", {\n        matchId: currentMatch.id,\n        sender: walletAddress,\n        message: chatInput\n      }) && setChatInput(\"\")\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 504,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => {\n        socket.emit(\"message\", {\n          matchId: currentMatch.id,\n          sender: walletAddress,\n          message: chatInput\n        });\n        setChatInput(\"\");\n      },\n      disabled: !chatInput.trim(),\n      children: \"Send\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 517,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 495,\n    columnNumber: 5\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"app\",\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Type Racer\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 536,\n        columnNumber: 9\n      }, this), connected ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"wallet-info\",\n        children: [walletAddress.slice(0, 6), \"\\u2026 (\", walletBalance.toFixed(2), \" SOL)\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 538,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(WalletMultiButton, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 542,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 535,\n      columnNumber: 7\n    }, this), !connected && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Please connect your wallet to play.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 546,\n      columnNumber: 22\n    }, this), connected && !currentMatch && renderMatchmaking(), connected && currentMatch && matchStatus === \"waiting\" && renderWaiting(), connected && currentMatch && (matchStatus === \"ready\" || matchStatus === \"racing\" || matchStatus === \"finished\") && renderRace(), connected && currentMatch && matchStatus === \"finished\" && renderChat()]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 534,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"ldBRgIm4aiKEkJ9uI+DoTqytkhA=\", false, function () {\n  return [useConnection, useWallet];\n});\n_c = App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","useRef","sentences","useConnection","useWallet","WalletMultiButton","LAMPORTS_PER_SOL","PublicKey","SystemProgram","Transaction","socket","anchor","idl","jsxDEV","_jsxDEV","Fragment","_Fragment","PROGRAM_ID","metadata","address","App","_s","connection","wallet","publicKey","connected","walletAddress","toBase58","providerRef","prov","AnchorProvider","preflightCommitment","setProvider","current","getProgram","Error","Program","walletBalance","setWalletBalance","getBalance","then","lamports","wager","setWager","openMatches","setOpenMatches","currentMatch","setCurrentMatch","matchStatus","setMatchStatus","sentence","setSentence","inputValue","setInputValue","playerProgress","setPlayerProgress","opponentProgress","setOpponentProgress","countdown","setCountdown","raceResult","setRaceResult","isInputDisabled","setIsInputDisabled","isAccepting","setIsAccepting","opponentWallet","setOpponentWallet","chatMessages","setChatMessages","chatInput","setChatInput","lastProgTime","setLastProgTime","Date","now","lastProg","setLastProg","MAX_CPS","inputRef","API","process","env","REACT_APP_API_URL","connect","on","m","os","id","filter","players","chooseSentence","find","w","progress","winner","progressMap","result","_progressMap$walletAd","_progressMap$opponent","resolve","e","console","error","resetGame","removeAllListeners","t","setTimeout","c","clearTimeout","_inputRef$current","focus","Array","from","reduce","a","charCodeAt","length","fetchOpenMatches","res","fetch","json","createMatch","alert","provider","Math","floor","program","nonce","random","escrowPda","findProgramAddress","Buffer","toBuffer","BN","toArrayLike","programId","ixInit","methods","initialize","accounts","escrow","player1","authority","systemProgram","instruction","ixDeposit","deposit","payer","escrowAccount","tx","add","feePayer","blockhash","lastValidBlockHeight","getLatestBlockhash","recentBlockhash","signed","signTransaction","err","message","sig","sendRawTransaction","serialize","skipPreflight","confirmTransaction","signature","method","headers","body","JSON","stringify","amount","Number","creator","feePercent","emit","acceptMatch","joinAndDeposit","player2","rpc","accepter","cancelMatch","cancel","winnerPubkey","escrowState","account","vaultPda","house","handleInput","type","preventDefault","val","target","value","rawProg","min","deltaProg","deltaTime","chars","cps","matchId","renderMatchmaking","className","children","fileName","_jsxFileName","lineNumber","columnNumber","step","onChange","onClick","disabled","style","marginTop","map","slice","marginLeft","renderWaiting","renderRace","ref","onPaste","placeholder","autoFocus","left","fontSize","textAlign","color","renderChat","maxHeight","overflowY","msg","i","sender","onKeyDown","key","trim","toFixed","_c","$RefreshReg$"],"sources":["/home/kokoi/sol-wager-app/frontend/src/App.jsx"],"sourcesContent":["// src/App.jsx\n\nimport React, { useState, useEffect, useRef } from \"react\";\nimport \"./App.css\";\nimport sentences from \"./sentences\";\nimport { useConnection, useWallet } from \"@solana/wallet-adapter-react\";\nimport { WalletMultiButton } from \"@solana/wallet-adapter-react-ui\";\nimport {\n  LAMPORTS_PER_SOL,\n  PublicKey,\n  SystemProgram,\n  Transaction,\n} from \"@solana/web3.js\";\nimport socket from \"./socket\";\nimport * as anchor from \"@coral-xyz/anchor\";\nimport idl from \"./idl/typeracer_escrow.json\";\n\n// Program ID from IDL\nconst PROGRAM_ID = new PublicKey(idl.metadata.address);\n\nexport default function App() {\n  const { connection } = useConnection();\n  const wallet = useWallet();\n  const { publicKey, connected } = wallet;\n  const walletAddress = publicKey?.toBase58() || \"\";\n\n  // Anchor provider setup\n  const providerRef = useRef(null);\n  useEffect(() => {\n    if (connected && connection) {\n      const prov = new anchor.AnchorProvider(connection, wallet, {\n        preflightCommitment: \"confirmed\",\n      });\n      anchor.setProvider(prov);\n      providerRef.current = prov;\n    }\n  }, [connected, connection, wallet]);\n\n  // Helper to get your Anchor Program\n  const getProgram = () => {\n    const prov = providerRef.current;\n    if (!prov) throw new Error(\"Provider not ready\");\n    return new anchor.Program(idl, PROGRAM_ID, prov);\n  };\n\n  // Wallet balance\n  const [walletBalance, setWalletBalance] = useState(0);\n  useEffect(() => {\n    if (connection && publicKey) {\n      connection.getBalance(publicKey).then((lamports) => {\n        setWalletBalance(lamports / LAMPORTS_PER_SOL);\n      });\n    }\n  }, [connection, publicKey]);\n\n  // Game & race state\n  const [wager, setWager] = useState(1);\n  const [openMatches, setOpenMatches] = useState([]);\n  const [currentMatch, setCurrentMatch] = useState(null);\n  const [matchStatus, setMatchStatus] = useState(\"waiting\");\n  const [sentence, setSentence] = useState(\"\");\n  const [inputValue, setInputValue] = useState(\"\");\n  const [playerProgress, setPlayerProgress] = useState(0);\n  const [opponentProgress, setOpponentProgress] = useState(0);\n  const [countdown, setCountdown] = useState(3);\n  const [raceResult, setRaceResult] = useState(null);\n  const [isInputDisabled, setIsInputDisabled] = useState(false);\n  const [isAccepting, setIsAccepting] = useState(false);\n  const [opponentWallet, setOpponentWallet] = useState(null);\n\n  // Chat\n  const [chatMessages, setChatMessages] = useState([]);\n  const [chatInput, setChatInput] = useState(\"\");\n\n  // Anti-cheat\n  const [lastProgTime, setLastProgTime] = useState(Date.now());\n  const [lastProg, setLastProg] = useState(0);\n  const MAX_CPS = 20;\n\n  const inputRef = useRef(null);\n  const API = process.env.REACT_APP_API_URL;\n\n  // Socket listeners\n  useEffect(() => {\n    socket.connect();\n    socket.on(\"openMatches\", setOpenMatches);\n    socket.on(\"newMatch\", (m) => setOpenMatches((os) => [...os, m]));\n    socket.on(\"removeMatch\", (id) =>\n      setOpenMatches((os) => os.filter((m) => m.id !== id))\n    );\n    socket.on(\"startMatch\", ({ id, players }) => {\n      if (currentMatch?.id === id) {\n        setMatchStatus(\"ready\");\n        setSentence(chooseSentence(id));\n        setCountdown(3);\n        setOpponentWallet(players.find((w) => w !== walletAddress));\n      }\n    });\n    socket.on(\"opponentProgress\", ({ wallet: w, progress }) => {\n      if (w !== walletAddress) setOpponentProgress(progress);\n    });\n    socket.on(\"raceEnd\", ({ winner, progressMap }) => {\n      setMatchStatus(\"finished\");\n      setIsInputDisabled(true);\n      setRaceResult({ result: winner === walletAddress ? \"win\" : \"lose\" });\n      if (progressMap) {\n        setPlayerProgress(progressMap[walletAddress] ?? 0);\n        setOpponentProgress(progressMap[opponentWallet] ?? 0);\n      }\n    });\n    socket.on(\"chat\", setChatMessages);\n    socket.on(\"opponentLeft\", async () => {\n      if (\n        matchStatus === \"finished\" &&\n        raceResult?.result === \"win\" &&\n        currentMatch?.id\n      ) {\n        try {\n          await resolve(currentMatch.id, publicKey);\n        } catch (e) {\n          console.error(\"Auto‚Äëclaim failed:\", e);\n        }\n      }\n      resetGame();\n    });\n    return () => socket.removeAllListeners();\n  }, [\n    currentMatch,\n    walletAddress,\n    opponentWallet,\n    matchStatus,\n    raceResult,\n    publicKey,\n  ]);\n\n  // Countdown\n  useEffect(() => {\n    if (matchStatus === \"ready\" && countdown > 0) {\n      const t = setTimeout(() => setCountdown((c) => c - 1), 1000);\n      return () => clearTimeout(t);\n    } else if (matchStatus === \"ready\" && countdown === 0) {\n      setMatchStatus(\"racing\");\n      setIsInputDisabled(false);\n      inputRef.current?.focus();\n    }\n  }, [countdown, matchStatus]);\n\n  // Helpers\n  const chooseSentence = (id) =>\n    sentences[\n      Array.from(id).reduce((a, c) => a + c.charCodeAt(0), 0) % sentences.length\n    ];\n  const fetchOpenMatches = async () => {\n    try {\n      const res = await fetch(`${API}/wagers`);\n      setOpenMatches(await res.json());\n    } catch {}\n  };\n  const resetGame = () => {\n    setCurrentMatch(null);\n    setMatchStatus(\"waiting\");\n    setSentence(\"\");\n    setInputValue(\"\");\n    setPlayerProgress(0);\n    setOpponentProgress(0);\n    setCountdown(3);\n    setRaceResult(null);\n    setIsInputDisabled(false);\n    setOpponentWallet(null);\n    setLastProg(0);\n    setLastProgTime(Date.now());\n    fetchOpenMatches();\n  };\n\n  // createMatch\n  async function createMatch() {\n    if (!connected) return alert(\"Connect wallet\");\n    const provider = providerRef.current;\n    if (!provider) return alert(\"Provider not ready\");\n\n    const lamports = Math.floor(wager * LAMPORTS_PER_SOL);\n    const program = getProgram();\n    const nonce = Math.floor(Math.random() * 1_000_000);\n\n    const [escrowPda] = await PublicKey.findProgramAddress(\n      [\n        Buffer.from(\"escrow\"),\n        provider.wallet.publicKey.toBuffer(),\n        new anchor.BN(nonce).toArrayLike(Buffer, \"le\", 8),\n      ],\n      program.programId\n    );\n\n    const ixInit = await program.methods\n      .initialize(new anchor.BN(lamports), new anchor.BN(nonce))\n      .accounts({\n        escrow: escrowPda,\n        player1: provider.wallet.publicKey,\n        authority: provider.wallet.publicKey,\n        systemProgram: SystemProgram.programId,\n      })\n      .instruction();\n\n    const ixDeposit = await program.methods\n      .deposit()\n      .accounts({\n        escrow: escrowPda,\n        payer: provider.wallet.publicKey,\n        escrowAccount: escrowPda,\n        systemProgram: SystemProgram.programId,\n      })\n      .instruction();\n\n    const tx = new Transaction().add(ixInit, ixDeposit);\n    tx.feePayer = provider.wallet.publicKey;\n    const { blockhash, lastValidBlockHeight } =\n      await provider.connection.getLatestBlockhash(\"confirmed\");\n    tx.recentBlockhash = blockhash;\n\n    let signed;\n    try {\n      signed = await provider.wallet.signTransaction(tx);\n    } catch (err) {\n      return alert(\"Signing failed: \" + err.message);\n    }\n\n    try {\n      const sig = await provider.connection.sendRawTransaction(\n        signed.serialize(),\n        { skipPreflight: false, preflightCommitment: \"confirmed\" }\n      );\n      await provider.connection.confirmTransaction(\n        { signature: sig, blockhash, lastValidBlockHeight },\n        \"confirmed\"\n      );\n    } catch (err) {\n      console.error(\"createMatch failed:\", err);\n      return alert(`Failed to create match:\\n${err.message || err}`);\n    }\n\n    const id = escrowPda.toBase58();\n    await fetch(`${API}/wagers`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({\n        id,\n        amount: Number(wager),\n        creator: walletAddress,\n        feePercent: 5,\n      }),\n    });\n    setCurrentMatch({ id, amount: Number(wager), creator: walletAddress });\n    socket.emit(\"joinMatch\", id);\n    setMatchStatus(\"waiting\");\n  }\n\n  // acceptMatch\n  async function acceptMatch(m) {\n    if (!connected) return alert(\"Connect wallet\");\n    setIsAccepting(true);\n    const program = getProgram();\n    try {\n      await program.methods\n        .joinAndDeposit()\n        .accounts({\n          escrow: new PublicKey(m.id),\n          player2: providerRef.current.wallet.publicKey,\n          escrowAccount: new PublicKey(m.id),\n          systemProgram: SystemProgram.programId,\n        })\n        .rpc();\n\n      await fetch(`${API}/wagers/${m.id}/accept`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ accepter: walletAddress }),\n      });\n      setCurrentMatch({ ...m, accepter: walletAddress });\n      setMatchStatus(\"ready\");\n      setCountdown(3);\n      socket.emit(\"joinMatch\", m.id);\n    } catch (e) {\n      console.error(\"acceptMatch failed:\", e);\n      alert(`Failed to accept match:\\n${e.message || e}`);\n      setCurrentMatch(null);\n    } finally {\n      setIsAccepting(false);\n    }\n  }\n\n  // cancelMatch\n  async function cancelMatch(m) {\n    const program = getProgram();\n    try {\n      await program.methods\n        .cancel()\n        .accounts({\n          escrow: new PublicKey(m.id),\n          player1: new PublicKey(m.creator),\n          player2: new PublicKey(m.accepter || m.creator),\n          escrowAccount: new PublicKey(m.id),\n          authority: providerRef.current.wallet.publicKey,\n        })\n        .rpc();\n\n      await fetch(`${API}/wagers/${m.id}/cancel`, { method: \"POST\" });\n      resetGame();\n    } catch (e) {\n      console.error(\"cancelMatch failed:\", e);\n      alert(`Failed to cancel match:\\n${e.message || e}`);\n    }\n  }\n\n  // resolve (claim)\n  async function resolve(id, winnerPubkey) {\n    const program = getProgram();\n    try {\n      const escrowPda = new PublicKey(id);\n      const escrowState = await program.account.escrow.fetch(escrowPda);\n      const vaultPda = new PublicKey(escrowState.escrowAccount);\n\n      const sig = await program.methods\n        .resolve(winnerPubkey)\n        .accounts({\n          escrow: escrowPda,\n          winner: winnerPubkey,\n          house: providerRef.current.wallet.publicKey,\n          escrowAccount: vaultPda,\n          authority: providerRef.current.wallet.publicKey,\n        })\n        .rpc();\n      return sig;\n    } catch (err) {\n      console.error(\"resolve failed:\", err);\n      throw err;\n    }\n  }\n\n  // handleInput\n  function handleInput(e) {\n    if (isInputDisabled) return;\n    if (e.type === \"paste\") {\n      e.preventDefault();\n      return;\n    }\n    const now = Date.now();\n    const val = e.target.value;\n    const rawProg = Math.min(1, val.length / sentence.length);\n    const deltaProg = rawProg - lastProg;\n    const deltaTime = (now - lastProgTime) / 1000;\n    const chars = deltaProg * sentence.length;\n    const cps = deltaTime > 0 ? chars / deltaTime : 0;\n    if (cps > MAX_CPS) return;\n    setLastProg(rawProg);\n    setLastProgTime(now);\n    setInputValue(val);\n    setPlayerProgress(rawProg);\n    socket.emit(\"progress\", {\n      matchId: currentMatch.id,\n      wallet: walletAddress,\n      progress: rawProg,\n    });\n    if (val === sentence) {\n      fetch(`${API}/wagers/${currentMatch.id}/complete`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ winner: walletAddress }),\n      });\n      setMatchStatus(\"finished\");\n      setIsInputDisabled(true);\n      setRaceResult({ result: \"win\" });\n    }\n  }\n\n  // renderMatchmaking\n  const renderMatchmaking = () => (\n    <section className=\"matchmaking\">\n      <h2>Create a Match</h2>\n      <label>\n        Wager (SOL):\n        <input\n          type=\"number\"\n          min=\"0.01\"\n          step=\"0.01\"\n          value={wager}\n          onChange={(e) => setWager(e.target.value)}\n        />\n      </label>\n      <button onClick={createMatch} disabled={!wager || wager <= 0}>\n        Create Match\n      </button>\n      <h2 style={{ marginTop: 20 }}>Open Matches</h2>\n      {openMatches.length === 0 ? (\n        <p>No open matches. Create one!</p>\n      ) : (\n        <ul>\n          {openMatches.map((m) => (\n            <li key={m.id}>\n              {m.id.slice(0, 6)}‚Ä¶ | {m.amount} SOL{\" \"}\n              {m.creator === walletAddress ? (\n                <button onClick={() => cancelMatch(m)} style={{ marginLeft: 10 }}>\n                  Cancel\n                </button>\n              ) : (\n                <button\n                  onClick={() => acceptMatch(m)}\n                  disabled={!!currentMatch || isAccepting}\n                  style={{ marginLeft: 10 }}\n                >\n                  {isAccepting ? \"Accepting‚Ä¶\" : \"Accept\"}\n                </button>\n              )}\n            </li>\n          ))}\n        </ul>\n      )}\n    </section>\n  );\n\n  // renderWaiting\n  const renderWaiting = () => (\n    <section className=\"waiting-section\">\n      <h2>Waiting for opponent‚Ä¶</h2>\n      <button onClick={() => cancelMatch(currentMatch)}>Cancel Match</button>\n    </section>\n  );\n\n  // renderRace\n  const renderRace = () => (\n    <section className=\"race-section\">\n      {matchStatus === \"ready\" && <h2>Starting in {countdown}</h2>}\n      {matchStatus === \"racing\" && (\n        <>\n          <div className=\"sentence-display\">{sentence}</div>\n          <input\n            ref={inputRef}\n            type=\"text\"\n            value={inputValue}\n            onChange={handleInput}\n            onPaste={handleInput}\n            placeholder=\"Start typing‚Ä¶\"\n            disabled={isInputDisabled}\n            autoFocus\n          />\n          <div className=\"track\">\n            <div className=\"lane\">\n              <div\n                className=\"car car-player\"\n                style={{ left: `${playerProgress * 100}%` }}\n              >\n                üöó\n              </div>\n            </div>\n            <div className=\"lane\">\n              <div\n                className=\"car car-opponent\"\n                style={{ left: `${opponentProgress * 100}%` }}\n              >\n                üèéÔ∏è\n              </div>\n            </div>\n          </div>\n        </>\n      )}\n      {matchStatus === \"finished\" && raceResult?.result === \"win\" && (\n        <div className=\"results results-win\">\n          <h2 style={{ fontSize: \"2rem\" }}>üèÜ You Won!</h2>\n          <button\n            onClick={async () => {\n              try {\n                await resolve(currentMatch.id, publicKey);\n                resetGame();\n              } catch (e) {\n                console.error(e);\n                alert(\"Payout error: \" + (e.message || e));\n              }\n            }}\n          >\n            Claim Winnings\n          </button>\n        </div>\n      )}\n      {matchStatus === \"finished\" && raceResult?.result === \"lose\" && (\n        <div className=\"results results-lose\" style={{ textAlign: \"center\" }}>\n          <h2 style={{ fontSize: \"2rem\", color: \"#c0392b\" }}>üò¢ You Lost!</h2>\n          <p>Better luck next time!</p>\n          <button onClick={resetGame}>Back to Matches</button>\n        </div>\n      )}\n    </section>\n  );\n\n  // renderChat\n  const renderChat = () => (\n    <section className=\"chat-section\">\n      <h2>Chat</h2>\n      <div className=\"chat-messages\" style={{ maxHeight: 150, overflowY: \"auto\" }}>\n        {chatMessages.map((msg, i) => (\n          <p key={i} className={msg.sender === walletAddress ? \"self\" : \"other\"}>\n            <strong>{msg.sender.slice(0, 6)}‚Ä¶:</strong> {msg.message}\n          </p>\n        ))}\n      </div>\n      <input\n        value={chatInput}\n        onChange={(e) => setChatInput(e.target.value)}\n        onKeyDown={(e) =>\n          e.key === \"Enter\" &&\n          socket.emit(\"message\", {\n            matchId: currentMatch.id,\n            sender: walletAddress,\n            message: chatInput,\n          }) &&\n          setChatInput(\"\")\n        }\n      />\n      <button\n        onClick={() => {\n          socket.emit(\"message\", {\n            matchId: currentMatch.id,\n            sender: walletAddress,\n            message: chatInput,\n          });\n          setChatInput(\"\");\n        }}\n        disabled={!chatInput.trim()}\n      >\n        Send\n      </button>\n    </section>\n  );\n\n  return (\n    <div className=\"app\">\n      <header>\n        <h1>Type Racer</h1>\n        {connected ? (\n          <div className=\"wallet-info\">\n            {walletAddress.slice(0, 6)}‚Ä¶ ({walletBalance.toFixed(2)} SOL)\n          </div>\n        ) : (\n          <WalletMultiButton />\n        )}\n      </header>\n\n      {!connected && <p>Please connect your wallet to play.</p>}\n      {connected && !currentMatch && renderMatchmaking()}\n      {connected && currentMatch && matchStatus === \"waiting\" && renderWaiting()}\n      {connected &&\n        currentMatch &&\n        (matchStatus === \"ready\" ||\n         matchStatus === \"racing\" ||\n         matchStatus === \"finished\") &&\n        renderRace()}\n      {connected && currentMatch && matchStatus === \"finished\" && renderChat()}\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}