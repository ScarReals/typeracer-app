{"ast":null,"code":"var _jsxFileName = \"/home/kokoi/typeracer-app/frontend/src/App.jsx\",\n  _s2 = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from \"react\";\nimport \"./App.css\";\nimport sentences from \"./sentences\";\nimport { useConnection, useWallet } from \"@solana/wallet-adapter-react\";\nimport { WalletMultiButton } from \"@solana/wallet-adapter-react-ui\";\nimport { LAMPORTS_PER_SOL, Transaction } from \"@solana/web3.js\";\nimport socket from \"./socket\";\nimport * as anchor from \"@coral-xyz/anchor\";\nimport { setProvider } from \"./solana\";\nimport { buildInitializeAndDepositIxns, buildJoinAndDepositIxn, buildCancelIxn, buildResolveIxn } from \"./escrow\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function App() {\n  _s2();\n  var _s = $RefreshSig$();\n  const {\n    connection\n  } = useConnection();\n  const wallet = useWallet();\n  const {\n    publicKey,\n    connected\n  } = wallet;\n  const walletAddress = (publicKey === null || publicKey === void 0 ? void 0 : publicKey.toBase58()) || \"\";\n  const walletAddressRef = useRef(walletAddress);\n  useEffect(() => {\n    walletAddressRef.current = walletAddress;\n  }, [walletAddress]);\n\n  // Solana Anchor Provider\n  useEffect(() => {\n    if (connected && connection) {\n      const prov = new anchor.AnchorProvider(connection, wallet, {\n        preflightCommitment: \"confirmed\",\n        commitment: \"confirmed\"\n      });\n      anchor.setProvider(prov);\n      setProvider(wallet);\n    }\n  }, [connected, connection, wallet]);\n\n  // Wallet balance\n  const [walletBalance, setWalletBalance] = useState(0);\n  useEffect(() => {\n    if (connection && publicKey) {\n      connection.getBalance(publicKey).then(lamports => {\n        setWalletBalance(lamports / LAMPORTS_PER_SOL);\n      });\n    }\n  }, [connection, publicKey]);\n\n  // Match states\n  const [wager, setWager] = useState(\"\");\n  const [openMatches, setOpenMatches] = useState([]);\n  const [currentMatch, setCurrentMatch] = useState(null);\n  const [matchStatus, setMatchStatus] = useState(\"waiting\");\n  const [isAccepting, setIsAccepting] = useState(false);\n  const API = process.env.REACT_APP_API_URL;\n\n  // Fetch open matches\n  const fetchOpenMatches = async () => {\n    try {\n      const res = await fetch(`${API}/wagers`);\n      const wm = await res.json();\n      setOpenMatches(wm.filter(m => !m.accepter));\n    } catch {}\n  };\n  useEffect(() => {\n    socket.connect();\n    socket.on(\"openMatches\", wm => setOpenMatches(wm.filter(m => !m.accepter)));\n    socket.on(\"newMatch\", m => setOpenMatches(os => [...os, m].filter(x => !x.accepter)));\n    socket.on(\"removeMatch\", id => setOpenMatches(os => os.filter(m => m.id !== id)));\n    fetchOpenMatches();\n    return () => {\n      socket.removeAllListeners();\n      socket.disconnect();\n    };\n  }, []);\n\n  // ────────────────────────────────────────────────\n  // Actions\n  async function createMatch() {\n    if (!connected) return alert(\"Connect wallet\");\n    if (!wager || wager <= 0) return alert(\"Enter a valid wager\");\n    try {\n      const lamports = Math.floor(wager * LAMPORTS_PER_SOL);\n      const nonce = Math.floor(Math.random() * 1000000);\n      const {\n        ixInit,\n        ixDeposit,\n        escrowPda\n      } = await buildInitializeAndDepositIxns(lamports, publicKey, nonce);\n      const tx = new Transaction().add(ixInit, ixDeposit);\n      await wallet.sendTransaction(tx, connection);\n      const id = escrowPda.toBase58();\n      await fetch(`${API}/wagers`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          id,\n          vault: id,\n          amount: Number(wager),\n          creator: walletAddressRef.current,\n          feePercent: 5,\n          nonce\n        })\n      });\n      setCurrentMatch({\n        id,\n        amount: Number(wager),\n        creator: walletAddressRef.current,\n        nonce\n      });\n      setMatchStatus(\"waiting\");\n      socket.emit(\"joinMatch\", id);\n      fetchOpenMatches();\n    } catch (e) {\n      console.error(\"Create error:\", e);\n      alert(\"Create match failed:\\n\" + e.message);\n    }\n  }\n  async function acceptMatch(m) {\n    if (!connected) return alert(\"Connect wallet\");\n    setIsAccepting(true);\n    try {\n      const ix = await buildJoinAndDepositIxn(m.id);\n      await wallet.sendTransaction(new Transaction().add(ix), connection);\n      await fetch(`${API}/wagers/${m.id}/accept`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          accepter: walletAddressRef.current\n        })\n      });\n      setCurrentMatch({\n        ...m,\n        accepter: walletAddressRef.current\n      });\n      setMatchStatus(\"ready\");\n      socket.emit(\"joinMatch\", m.id);\n    } catch (e) {\n      console.error(\"Accept error:\", e);\n      alert(\"Accept error:\\n\" + e.message);\n    } finally {\n      setIsAccepting(false);\n    }\n  }\n\n  // ────────────────────────────────────────────────\n  // Homepage UI\n  const renderHome = () => /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"homepage\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"hero-title\",\n      children: \"TypeRacer\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"hero-subtitle\",\n      children: \"Race against others in real-time typing matches. Place your bet and win SOL!\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"home-grid\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card create-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Create Match\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Set your wager and create a new match\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"preset-buttons\",\n          children: [0.1, 0.5, 1].map(amt => /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setWager(amt),\n            className: wager === amt ? \"active\" : \"\",\n            children: [amt, \" SOL\"]\n          }, amt, true, {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          step: \"0.01\",\n          min: \"0.01\",\n          placeholder: \"Custom amount\",\n          value: wager,\n          onChange: e => setWager(Number(e.target.value))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"primary-btn\",\n          onClick: createMatch,\n          children: \"Create Match\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card join-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Join Match\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Browse open matches and join instantly\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"match-list\",\n          children: [openMatches.length === 0 && /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"No open matches available\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 42\n          }, this), openMatches.map(m => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"match-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: [m.id.slice(0, 6), \"\\u2026\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 203,\n                columnNumber: 19\n              }, this), \" | \", m.amount, \" SOL\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 202,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => acceptMatch(m),\n              disabled: isAccepting,\n              className: \"secondary-btn\",\n              children: isAccepting ? \"Joining…\" : \"Join\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 17\n            }, this)]\n          }, m.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 201,\n            columnNumber: 15\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 159,\n    columnNumber: 5\n  }, this);\n\n  // return will be added in Part 3\n  // ────────────────────────────────────────────────\n  // Race state (continued)\n  const [matchCreatedAt, setMatchCreatedAt] = useState(0);\n  const [timeLeft, setTimeLeft] = useState(0);\n  const [sentence, setSentence] = useState(\"\");\n  const [inputValue, setInputValue] = useState(\"\");\n  const [playerProgress, setPlayerProgress] = useState(0);\n  const [opponentProgress, setOpponentProgress] = useState(0);\n  const [countdown, setCountdown] = useState(3);\n  const [raceResult, setRaceResult] = useState(null);\n  const [isInputDisabled, setIsInputDisabled] = useState(false);\n  const [opponentWallet, setOpponentWallet] = useState(null);\n  const [hasError, setHasError] = useState(false);\n  const [chatMessages, setChatMessages] = useState([]);\n  const [chatInput, setChatInput] = useState(\"\");\n  const inputRef = useRef(null);\n\n  // anti-spam typing limiter\n  const [lastProgTime, setLastProgTime] = useState(Date.now());\n  const [lastProg, setLastProg] = useState(0);\n  const MAX_CPS = 20;\n\n  // helper: deterministic sentence per match id\n  const chooseSentence = id => sentences[Array.from(id).reduce((a, c) => a + c.charCodeAt(0), 0) % sentences.length];\n\n  // Timer for cancel window (90s after create)\n  useEffect(() => {\n    if (!matchCreatedAt) return;\n    const tick = () => {\n      const elapsed = Date.now() - matchCreatedAt;\n      const secs = Math.ceil((90000 - elapsed) / 1000);\n      setTimeLeft(secs > 0 ? secs : 0);\n    };\n    tick();\n    const iv = setInterval(tick, 1000);\n    return () => clearInterval(iv);\n  }, [matchCreatedAt]);\n\n  // Socket events for active match lifecycle\n  useEffect(() => {\n    const onStart = ({\n      id,\n      players\n    }) => {\n      // ensure we receive in-room progress\n      socket.emit(\"joinMatch\", id);\n      setPlayerProgress(0);\n      setOpponentProgress(0);\n      setCurrentMatch(prev => ({\n        id,\n        amount: (prev === null || prev === void 0 ? void 0 : prev.amount) || 0,\n        creator: players[0],\n        accepter: players[1],\n        nonce: prev === null || prev === void 0 ? void 0 : prev.nonce\n      }));\n      setMatchStatus(\"ready\");\n      setSentence(chooseSentence(id));\n      setCountdown(3);\n      setOpponentWallet(players.find(w => w !== walletAddress));\n      setHasError(false);\n    };\n    const onOppProg = ({\n      wallet: w,\n      progress\n    }) => {\n      if (w !== walletAddress) setOpponentProgress(progress);\n    };\n    const onRaceEnd = ({\n      winner,\n      progressMap\n    }) => {\n      setMatchStatus(\"finished\");\n      setIsInputDisabled(true);\n      setRaceResult({\n        result: winner === walletAddress ? \"win\" : \"lose\"\n      });\n      if (progressMap) {\n        var _progressMap$walletAd, _progressMap$opponent;\n        setPlayerProgress((_progressMap$walletAd = progressMap[walletAddress]) !== null && _progressMap$walletAd !== void 0 ? _progressMap$walletAd : 0);\n        setOpponentProgress((_progressMap$opponent = progressMap[opponentWallet]) !== null && _progressMap$opponent !== void 0 ? _progressMap$opponent : 0);\n      }\n    };\n    const onChat = msgs => setChatMessages(msgs);\n    const onOpponentLeft = () => resetGame();\n    socket.on(\"startMatch\", onStart);\n    socket.on(\"opponentProgress\", onOppProg);\n    socket.on(\"raceEnd\", onRaceEnd);\n    socket.on(\"chat\", onChat);\n    socket.on(\"opponentLeft\", onOpponentLeft);\n    return () => {\n      socket.off(\"startMatch\", onStart);\n      socket.off(\"opponentProgress\", onOppProg);\n      socket.off(\"raceEnd\", onRaceEnd);\n      socket.off(\"chat\", onChat);\n      socket.off(\"opponentLeft\", onOpponentLeft);\n    };\n  }, [walletAddress, opponentWallet]);\n\n  // Countdown → go\n  useEffect(() => {\n    if (matchStatus === \"ready\" && countdown > 0) {\n      const t = setTimeout(() => setCountdown(c => c - 1), 1000);\n      return () => clearTimeout(t);\n    } else if (matchStatus === \"ready\" && countdown === 0) {\n      var _inputRef$current;\n      setMatchStatus(\"racing\");\n      setIsInputDisabled(false);\n      (_inputRef$current = inputRef.current) === null || _inputRef$current === void 0 ? void 0 : _inputRef$current.focus();\n    }\n  }, [countdown, matchStatus]);\n\n  // Reset (home)\n  const resetGame = () => {\n    setCurrentMatch(null);\n    setMatchStatus(\"waiting\");\n    setSentence(\"\");\n    setInputValue(\"\");\n    setPlayerProgress(0);\n    setOpponentProgress(0);\n    setCountdown(3);\n    setRaceResult(null);\n    setIsInputDisabled(false);\n    setOpponentWallet(null);\n    setLastProg(0);\n    setLastProgTime(Date.now());\n    setMatchCreatedAt(0);\n    setTimeLeft(0);\n    setHasError(false);\n    fetchOpenMatches();\n  };\n\n  // Cancel within grace window (or any time if server allows)\n  const CAN_CANCEL = timeLeft === 0 && matchStatus === \"waiting\";\n  async function cancelMatch(m) {\n    try {\n      const ix = await buildCancelIxn(m.id, m.creator, m.accepter || m.creator);\n      await wallet.sendTransaction(new Transaction().add(ix), connection);\n      await fetch(`${API}/wagers/${m.id}/cancel`, {\n        method: \"POST\"\n      });\n      resetGame();\n    } catch (e) {\n      console.error(\"Cancel error:\", e);\n      alert(\"Cancel error:\\n\" + e.message);\n    }\n  }\n\n  // Typing handler with anti-paste and cps cap\n  function handleInput(e) {\n    if (isInputDisabled) return;\n    if (e.type === \"paste\") {\n      e.preventDefault();\n      return;\n    }\n    const val = e.target.value;\n    if (!sentence.startsWith(val)) {\n      setHasError(true);\n      return;\n    }\n    setHasError(false);\n    const now = Date.now();\n    const raw = Math.min(1, val.length / sentence.length);\n    const delta = raw - lastProg;\n    const dt = (now - lastProgTime) / 1000;\n    const cps = dt > 0 ? delta * sentence.length / dt : 0;\n    if (cps > MAX_CPS) return;\n    setLastProg(raw);\n    setLastProgTime(now);\n    setInputValue(val);\n    setPlayerProgress(raw);\n    if (currentMatch !== null && currentMatch !== void 0 && currentMatch.id) {\n      socket.emit(\"progress\", {\n        matchId: currentMatch.id,\n        wallet: walletAddress,\n        progress: raw\n      });\n    }\n    if (val === sentence && currentMatch !== null && currentMatch !== void 0 && currentMatch.id) {\n      fetch(`${API}/wagers/${currentMatch.id}/complete`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          winner: walletAddress\n        })\n      });\n      setMatchStatus(\"finished\");\n      setIsInputDisabled(true);\n      setRaceResult({\n        result: \"win\"\n      });\n    }\n  }\n\n  // ────────────────────────────────────────────────\n  // Fullscreen Match Views (modals visually, but we take the whole screen)\n  const WaitingView = () => currentMatch && matchStatus === \"waiting\" ? /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"match-screen\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"match-panel\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"panel-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Match Lobby\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 417,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"pill\",\n          children: [currentMatch.amount, \" SOL\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 418,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 416,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"panel-grid\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"panel card\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Match Info\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 422,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"kv\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Match ID:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 423,\n              columnNumber: 35\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\"#\", currentMatch.id.slice(0, 6)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 423,\n              columnNumber: 57\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 423,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"kv\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Creator:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 424,\n              columnNumber: 35\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [currentMatch.creator.slice(0, 6), \"\\u2026\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 424,\n              columnNumber: 56\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 424,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"kv\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Status:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 425,\n              columnNumber: 35\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"ok\",\n              children: \"Waiting for opponent\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 425,\n              columnNumber: 55\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 425,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 421,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"panel card\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Players\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 428,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"player-row you\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"dot\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 430,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"who\",\n              children: \"You\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 431,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"addr\",\n              children: [walletAddress.slice(0, 6), \"\\u2026\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 432,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 429,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"player-row\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"dot muted\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 435,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"who muted\",\n              children: \"Waiting for player\\u2026\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 436,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 434,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 427,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 420,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"panel-actions\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn danger\",\n          onClick: () => cancelMatch(currentMatch),\n          disabled: !CAN_CANCEL,\n          children: \"Cancel Match\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 442,\n          columnNumber: 13\n        }, this), !CAN_CANCEL && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"muted small\",\n          children: \"Cancel becomes available when the grace period ends.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 450,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 441,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 415,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 414,\n    columnNumber: 7\n  }, this) : null;\n  const ReadyOrRacingView = () => currentMatch && (matchStatus === \"ready\" || matchStatus === \"racing\") ? /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"match-screen\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"race-wrap\",\n      children: matchStatus === \"ready\" ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"start-count\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"big-ring\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ring-inner\",\n            children: countdown\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 464,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 463,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"start-text\",\n          children: \"Race Starting\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 466,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"muted\",\n          children: \"Get ready to type!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 467,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 462,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"sentence card mono\",\n          children: sentence\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 471,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          ref: inputRef,\n          type: \"text\",\n          value: inputValue,\n          onChange: handleInput,\n          onPaste: handleInput,\n          placeholder: \"Start typing\\u2026\",\n          disabled: isInputDisabled,\n          autoFocus: true,\n          className: `type-input mono ${hasError ? \"error\" : \"\"}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 472,\n          columnNumber: 15\n        }, this), hasError && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"error-note\",\n          children: \"Mistake detected \\u2014 correct it before continuing.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 484,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"track\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lane\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"car player\",\n              style: {\n                left: `calc(${playerProgress * 100}% - 28px)`\n              },\n              \"aria-label\": \"Your car\",\n              children: \"\\uD83D\\uDE97\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 489,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 488,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lane\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"car foe\",\n              style: {\n                left: `calc(${opponentProgress * 100}% - 28px)`\n              },\n              \"aria-label\": \"Opponent car\",\n              children: \"\\uD83C\\uDFCE\\uFE0F\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 498,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 497,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 487,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 460,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 459,\n    columnNumber: 7\n  }, this) : null;\n  const ResultsView = () => matchStatus === \"finished\" && currentMatch ? /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"match-screen\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"results-card card\",\n      children: (raceResult === null || raceResult === void 0 ? void 0 : raceResult.result) === \"win\" ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"result-emoji\",\n          children: \"\\uD83C\\uDFC6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 519,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"result-title ok\",\n          children: \"Victory!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 520,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"muted\",\n          children: [\"Claim your prize of \", currentMatch.amount, \" SOL\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 521,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"actions\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn primary\",\n            onClick: async () => {\n              try {\n                const ix = await buildResolveIxn(currentMatch.id, walletAddress);\n                const tx = new Transaction().add(ix);\n                await wallet.sendTransaction(tx, connection);\n                resetGame();\n              } catch (e) {\n                console.error(\"Claim error:\", e);\n                alert(\"Payout error:\\n\" + e.message);\n              }\n            },\n            children: \"Claim Winnings\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 523,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn outline\",\n            onClick: resetGame,\n            children: \"Back to Home\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 542,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 522,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"result-emoji\",\n          children: \"\\u274C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 549,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"result-title danger\",\n          children: \"Defeat\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 550,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"muted\",\n          children: \"Better luck next time.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 551,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"actions\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn outline\",\n            onClick: resetGame,\n            children: \"Back to Home\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 553,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 552,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 516,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat card\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Match Chat\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 562,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chat-messages\",\n        children: chatMessages.map((msg, i) => /*#__PURE__*/_jsxDEV(\"p\", {\n          className: msg.sender === walletAddress ? \"self\" : \"other\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: [msg.sender.slice(0, 6), \"\\u2026:\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 569,\n            columnNumber: 17\n          }, this), \" \", msg.message]\n        }, i, true, {\n          fileName: _jsxFileName,\n          lineNumber: 565,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 563,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chat-input\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          value: chatInput,\n          onChange: e => setChatInput(e.target.value),\n          onKeyDown: e => e.key === \"Enter\" && socket.emit(\"message\", {\n            matchId: currentMatch.id,\n            sender: walletAddress,\n            message: chatInput\n          }) && setChatInput(\"\"),\n          placeholder: \"Type message\\u2026\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 574,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn\",\n          disabled: !chatInput.trim(),\n          onClick: () => {\n            socket.emit(\"message\", {\n              matchId: currentMatch.id,\n              sender: walletAddress,\n              message: chatInput\n            });\n            setChatInput(\"\");\n          },\n          children: \"Send\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 588,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 573,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 561,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 515,\n    columnNumber: 7\n  }, this) : null;\n  // ────────────────────────────────────────────────\n  // EXTRA HOMEPAGE SECTIONS\n  const HowItWorks = () => /*#__PURE__*/_jsxDEV(\"section\", {\n    className: \"how-section\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"How It Works\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 610,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"how-grid\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"how-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"how-num\",\n          children: \"1\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 613,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Create\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 614,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Pick a wager amount and open a match.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 615,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 612,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"how-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"how-num\",\n          children: \"2\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 618,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Join\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 619,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Join an open match with your wallet.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 620,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 617,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"how-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"how-num\",\n          children: \"3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 623,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Race & Win\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 624,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Type fastest to win the entire pot.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 625,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 622,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 611,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 609,\n    columnNumber: 5\n  }, this);\n  const FAQ = () => {\n    _s();\n    const [open, setOpen] = useState(null);\n    const items = [{\n      q: \"What is TypeRacer?\",\n      a: \"A realtime typing game on Solana. Create or join a match, race, and the winner takes the pot.\"\n    }, {\n      q: \"How are payouts handled?\",\n      a: \"When the server declares the winner, the on-chain program pays the winner instantly (minus fee).\"\n    }, {\n      q: \"Can I choose any wager?\",\n      a: \"Yes. Use the presets or type a custom SOL amount (must be > 0).\"\n    }];\n    return /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"faq-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"FAQ\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 649,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"faq-list\",\n        children: items.map((it, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `faq-item ${open === i ? \"open\" : \"\"}`,\n          onClick: () => setOpen(open === i ? null : i),\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"faq-q\",\n            children: it.q\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 657,\n            columnNumber: 15\n          }, this), open === i && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"faq-a\",\n            children: it.a\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 658,\n            columnNumber: 30\n          }, this)]\n        }, i, true, {\n          fileName: _jsxFileName,\n          lineNumber: 652,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 650,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 648,\n      columnNumber: 7\n    }, this);\n  };\n\n  // If we created a match but forgot to stamp the timer, start now\n  _s(FAQ, \"3gHT60S3lHEhyYybFcB05ha95j4=\");\n  useEffect(() => {\n    if (currentMatch && matchStatus === \"waiting\" && !matchCreatedAt) {\n      setMatchCreatedAt(Date.now());\n    }\n  }, [currentMatch, matchStatus, matchCreatedAt]);\n\n  // ────────────────────────────────────────────────\n  // FINAL RETURN (homepage vs. full match views)\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"app-shell\",\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"topbar\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"brand\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"dot\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 679,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"brand-text\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"brand-title\",\n            children: \"TypeRacer\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 681,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"brand-sub\",\n            children: \"Race to win SOL\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 682,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 680,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 678,\n        columnNumber: 9\n      }, this), connected ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"wallet-pill\",\n        children: [walletAddress.slice(0, 6), \"\\u2026 (\", walletBalance.toFixed(2), \" SOL)\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 687,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(WalletMultiButton, {\n        className: \"connect-btn\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 691,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 677,\n      columnNumber: 7\n    }, this), (!currentMatch || matchStatus === \"waiting\") && !currentMatch && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [renderHome(), /*#__PURE__*/_jsxDEV(HowItWorks, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 699,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(FAQ, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 700,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true), WaitingView(), ReadyOrRacingView(), ResultsView()]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 676,\n    columnNumber: 5\n  }, this);\n}\n_s2(App, \"RFNvZoM8E+kGn4cQAkrQfKx2vN4=\", false, function () {\n  return [useConnection, useWallet];\n});\n_c = App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","useRef","sentences","useConnection","useWallet","WalletMultiButton","LAMPORTS_PER_SOL","Transaction","socket","anchor","setProvider","buildInitializeAndDepositIxns","buildJoinAndDepositIxn","buildCancelIxn","buildResolveIxn","jsxDEV","_jsxDEV","Fragment","_Fragment","App","_s2","_s","$RefreshSig$","connection","wallet","publicKey","connected","walletAddress","toBase58","walletAddressRef","current","prov","AnchorProvider","preflightCommitment","commitment","walletBalance","setWalletBalance","getBalance","then","lamports","wager","setWager","openMatches","setOpenMatches","currentMatch","setCurrentMatch","matchStatus","setMatchStatus","isAccepting","setIsAccepting","API","process","env","REACT_APP_API_URL","fetchOpenMatches","res","fetch","wm","json","filter","m","accepter","connect","on","os","x","id","removeAllListeners","disconnect","createMatch","alert","Math","floor","nonce","random","ixInit","ixDeposit","escrowPda","tx","add","sendTransaction","method","headers","body","JSON","stringify","vault","amount","Number","creator","feePercent","emit","e","console","error","message","acceptMatch","ix","renderHome","className","children","fileName","_jsxFileName","lineNumber","columnNumber","map","amt","onClick","type","step","min","placeholder","value","onChange","target","length","slice","disabled","matchCreatedAt","setMatchCreatedAt","timeLeft","setTimeLeft","sentence","setSentence","inputValue","setInputValue","playerProgress","setPlayerProgress","opponentProgress","setOpponentProgress","countdown","setCountdown","raceResult","setRaceResult","isInputDisabled","setIsInputDisabled","opponentWallet","setOpponentWallet","hasError","setHasError","chatMessages","setChatMessages","chatInput","setChatInput","inputRef","lastProgTime","setLastProgTime","Date","now","lastProg","setLastProg","MAX_CPS","chooseSentence","Array","from","reduce","a","c","charCodeAt","tick","elapsed","secs","ceil","iv","setInterval","clearInterval","onStart","players","prev","find","w","onOppProg","progress","onRaceEnd","winner","progressMap","result","_progressMap$walletAd","_progressMap$opponent","onChat","msgs","onOpponentLeft","resetGame","off","t","setTimeout","clearTimeout","_inputRef$current","focus","CAN_CANCEL","cancelMatch","handleInput","preventDefault","val","startsWith","raw","delta","dt","cps","matchId","WaitingView","ReadyOrRacingView","ref","onPaste","autoFocus","style","left","ResultsView","msg","i","sender","onKeyDown","key","trim","HowItWorks","FAQ","open","setOpen","items","q","it","toFixed","_c","$RefreshReg$"],"sources":["/home/kokoi/typeracer-app/frontend/src/App.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport \"./App.css\";\nimport sentences from \"./sentences\";\nimport { useConnection, useWallet } from \"@solana/wallet-adapter-react\";\nimport { WalletMultiButton } from \"@solana/wallet-adapter-react-ui\";\nimport { LAMPORTS_PER_SOL, Transaction } from \"@solana/web3.js\";\nimport socket from \"./socket\";\nimport * as anchor from \"@coral-xyz/anchor\";\nimport { setProvider } from \"./solana\";\nimport {\n  buildInitializeAndDepositIxns,\n  buildJoinAndDepositIxn,\n  buildCancelIxn,\n  buildResolveIxn,\n} from \"./escrow\";\n\nexport default function App() {\n  const { connection } = useConnection();\n  const wallet = useWallet();\n  const { publicKey, connected } = wallet;\n  const walletAddress = publicKey?.toBase58() || \"\";\n\n  const walletAddressRef = useRef(walletAddress);\n  useEffect(() => {\n    walletAddressRef.current = walletAddress;\n  }, [walletAddress]);\n\n  // Solana Anchor Provider\n  useEffect(() => {\n    if (connected && connection) {\n      const prov = new anchor.AnchorProvider(connection, wallet, {\n        preflightCommitment: \"confirmed\",\n        commitment: \"confirmed\",\n      });\n      anchor.setProvider(prov);\n      setProvider(wallet);\n    }\n  }, [connected, connection, wallet]);\n\n  // Wallet balance\n  const [walletBalance, setWalletBalance] = useState(0);\n  useEffect(() => {\n    if (connection && publicKey) {\n      connection.getBalance(publicKey).then((lamports) => {\n        setWalletBalance(lamports / LAMPORTS_PER_SOL);\n      });\n    }\n  }, [connection, publicKey]);\n\n  // Match states\n  const [wager, setWager] = useState(\"\");\n  const [openMatches, setOpenMatches] = useState([]);\n  const [currentMatch, setCurrentMatch] = useState(null);\n  const [matchStatus, setMatchStatus] = useState(\"waiting\");\n\n  const [isAccepting, setIsAccepting] = useState(false);\n\n  const API = process.env.REACT_APP_API_URL;\n\n  // Fetch open matches\n  const fetchOpenMatches = async () => {\n    try {\n      const res = await fetch(`${API}/wagers`);\n      const wm = await res.json();\n      setOpenMatches(wm.filter((m) => !m.accepter));\n    } catch {}\n  };\n\n  useEffect(() => {\n    socket.connect();\n    socket.on(\"openMatches\", (wm) =>\n      setOpenMatches(wm.filter((m) => !m.accepter))\n    );\n    socket.on(\"newMatch\", (m) =>\n      setOpenMatches((os) => [...os, m].filter((x) => !x.accepter))\n    );\n    socket.on(\"removeMatch\", (id) =>\n      setOpenMatches((os) => os.filter((m) => m.id !== id))\n    );\n\n    fetchOpenMatches();\n    return () => {\n      socket.removeAllListeners();\n      socket.disconnect();\n    };\n  }, []);\n\n  // ────────────────────────────────────────────────\n  // Actions\n  async function createMatch() {\n    if (!connected) return alert(\"Connect wallet\");\n    if (!wager || wager <= 0) return alert(\"Enter a valid wager\");\n\n    try {\n      const lamports = Math.floor(wager * LAMPORTS_PER_SOL);\n      const nonce = Math.floor(Math.random() * 1_000_000);\n      const { ixInit, ixDeposit, escrowPda } =\n        await buildInitializeAndDepositIxns(lamports, publicKey, nonce);\n\n      const tx = new Transaction().add(ixInit, ixDeposit);\n      await wallet.sendTransaction(tx, connection);\n\n      const id = escrowPda.toBase58();\n      await fetch(`${API}/wagers`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          id,\n          vault: id,\n          amount: Number(wager),\n          creator: walletAddressRef.current,\n          feePercent: 5,\n          nonce,\n        }),\n      });\n\n      setCurrentMatch({\n        id,\n        amount: Number(wager),\n        creator: walletAddressRef.current,\n        nonce,\n      });\n      setMatchStatus(\"waiting\");\n      socket.emit(\"joinMatch\", id);\n      fetchOpenMatches();\n    } catch (e) {\n      console.error(\"Create error:\", e);\n      alert(\"Create match failed:\\n\" + e.message);\n    }\n  }\n\n  async function acceptMatch(m) {\n    if (!connected) return alert(\"Connect wallet\");\n    setIsAccepting(true);\n    try {\n      const ix = await buildJoinAndDepositIxn(m.id);\n      await wallet.sendTransaction(new Transaction().add(ix), connection);\n\n      await fetch(`${API}/wagers/${m.id}/accept`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ accepter: walletAddressRef.current }),\n      });\n\n      setCurrentMatch({ ...m, accepter: walletAddressRef.current });\n      setMatchStatus(\"ready\");\n      socket.emit(\"joinMatch\", m.id);\n    } catch (e) {\n      console.error(\"Accept error:\", e);\n      alert(\"Accept error:\\n\" + e.message);\n    } finally {\n      setIsAccepting(false);\n    }\n  }\n\n  // ────────────────────────────────────────────────\n  // Homepage UI\n  const renderHome = () => (\n    <div className=\"homepage\">\n      <h1 className=\"hero-title\">TypeRacer</h1>\n      <p className=\"hero-subtitle\">\n        Race against others in real-time typing matches. Place your bet and win SOL!\n      </p>\n\n      <div className=\"home-grid\">\n        {/* Create Match */}\n        <div className=\"card create-card\">\n          <h2>Create Match</h2>\n          <p>Set your wager and create a new match</p>\n          <div className=\"preset-buttons\">\n            {[0.1, 0.5, 1].map((amt) => (\n              <button\n                key={amt}\n                onClick={() => setWager(amt)}\n                className={wager === amt ? \"active\" : \"\"}\n              >\n                {amt} SOL\n              </button>\n            ))}\n          </div>\n          <input\n            type=\"number\"\n            step=\"0.01\"\n            min=\"0.01\"\n            placeholder=\"Custom amount\"\n            value={wager}\n            onChange={(e) => setWager(Number(e.target.value))}\n          />\n          <button className=\"primary-btn\" onClick={createMatch}>\n            Create Match\n          </button>\n        </div>\n\n        {/* Join Match */}\n        <div className=\"card join-card\">\n          <h2>Join Match</h2>\n          <p>Browse open matches and join instantly</p>\n          <div className=\"match-list\">\n            {openMatches.length === 0 && <p>No open matches available</p>}\n            {openMatches.map((m) => (\n              <div className=\"match-item\" key={m.id}>\n                <div>\n                  <strong>{m.id.slice(0, 6)}…</strong> | {m.amount} SOL\n                </div>\n                <button\n                  onClick={() => acceptMatch(m)}\n                  disabled={isAccepting}\n                  className=\"secondary-btn\"\n                >\n                  {isAccepting ? \"Joining…\" : \"Join\"}\n                </button>\n              </div>\n            ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n\n  // return will be added in Part 3\n  // ────────────────────────────────────────────────\n  // Race state (continued)\n  const [matchCreatedAt, setMatchCreatedAt] = useState(0);\n  const [timeLeft, setTimeLeft] = useState(0);\n  const [sentence, setSentence] = useState(\"\");\n  const [inputValue, setInputValue] = useState(\"\");\n  const [playerProgress, setPlayerProgress] = useState(0);\n  const [opponentProgress, setOpponentProgress] = useState(0);\n  const [countdown, setCountdown] = useState(3);\n  const [raceResult, setRaceResult] = useState(null);\n  const [isInputDisabled, setIsInputDisabled] = useState(false);\n  const [opponentWallet, setOpponentWallet] = useState(null);\n\n  const [hasError, setHasError] = useState(false);\n  const [chatMessages, setChatMessages] = useState([]);\n  const [chatInput, setChatInput] = useState(\"\");\n  const inputRef = useRef(null);\n\n  // anti-spam typing limiter\n  const [lastProgTime, setLastProgTime] = useState(Date.now());\n  const [lastProg, setLastProg] = useState(0);\n  const MAX_CPS = 20;\n\n  // helper: deterministic sentence per match id\n  const chooseSentence = (id) =>\n    sentences[\n      Array.from(id).reduce((a, c) => a + c.charCodeAt(0), 0) % sentences.length\n    ];\n\n  // Timer for cancel window (90s after create)\n  useEffect(() => {\n    if (!matchCreatedAt) return;\n    const tick = () => {\n      const elapsed = Date.now() - matchCreatedAt;\n      const secs = Math.ceil((90_000 - elapsed) / 1000);\n      setTimeLeft(secs > 0 ? secs : 0);\n    };\n    tick();\n    const iv = setInterval(tick, 1000);\n    return () => clearInterval(iv);\n  }, [matchCreatedAt]);\n\n  // Socket events for active match lifecycle\n  useEffect(() => {\n    const onStart = ({ id, players }) => {\n      // ensure we receive in-room progress\n      socket.emit(\"joinMatch\", id);\n      setPlayerProgress(0);\n      setOpponentProgress(0);\n      setCurrentMatch((prev) => ({\n        id,\n        amount: prev?.amount || 0,\n        creator: players[0],\n        accepter: players[1],\n        nonce: prev?.nonce,\n      }));\n      setMatchStatus(\"ready\");\n      setSentence(chooseSentence(id));\n      setCountdown(3);\n      setOpponentWallet(players.find((w) => w !== walletAddress));\n      setHasError(false);\n    };\n\n    const onOppProg = ({ wallet: w, progress }) => {\n      if (w !== walletAddress) setOpponentProgress(progress);\n    };\n\n    const onRaceEnd = ({ winner, progressMap }) => {\n      setMatchStatus(\"finished\");\n      setIsInputDisabled(true);\n      setRaceResult({\n        result: winner === walletAddress ? \"win\" : \"lose\",\n      });\n      if (progressMap) {\n        setPlayerProgress(progressMap[walletAddress] ?? 0);\n        setOpponentProgress(progressMap[opponentWallet] ?? 0);\n      }\n    };\n\n    const onChat = (msgs) => setChatMessages(msgs);\n    const onOpponentLeft = () => resetGame();\n\n    socket.on(\"startMatch\", onStart);\n    socket.on(\"opponentProgress\", onOppProg);\n    socket.on(\"raceEnd\", onRaceEnd);\n    socket.on(\"chat\", onChat);\n    socket.on(\"opponentLeft\", onOpponentLeft);\n\n    return () => {\n      socket.off(\"startMatch\", onStart);\n      socket.off(\"opponentProgress\", onOppProg);\n      socket.off(\"raceEnd\", onRaceEnd);\n      socket.off(\"chat\", onChat);\n      socket.off(\"opponentLeft\", onOpponentLeft);\n    };\n  }, [walletAddress, opponentWallet]);\n\n  // Countdown → go\n  useEffect(() => {\n    if (matchStatus === \"ready\" && countdown > 0) {\n      const t = setTimeout(() => setCountdown((c) => c - 1), 1000);\n      return () => clearTimeout(t);\n    } else if (matchStatus === \"ready\" && countdown === 0) {\n      setMatchStatus(\"racing\");\n      setIsInputDisabled(false);\n      inputRef.current?.focus();\n    }\n  }, [countdown, matchStatus]);\n\n  // Reset (home)\n  const resetGame = () => {\n    setCurrentMatch(null);\n    setMatchStatus(\"waiting\");\n    setSentence(\"\");\n    setInputValue(\"\");\n    setPlayerProgress(0);\n    setOpponentProgress(0);\n    setCountdown(3);\n    setRaceResult(null);\n    setIsInputDisabled(false);\n    setOpponentWallet(null);\n    setLastProg(0);\n    setLastProgTime(Date.now());\n    setMatchCreatedAt(0);\n    setTimeLeft(0);\n    setHasError(false);\n    fetchOpenMatches();\n  };\n\n  // Cancel within grace window (or any time if server allows)\n  const CAN_CANCEL = timeLeft === 0 && matchStatus === \"waiting\";\n  async function cancelMatch(m) {\n    try {\n      const ix = await buildCancelIxn(m.id, m.creator, m.accepter || m.creator);\n      await wallet.sendTransaction(new Transaction().add(ix), connection);\n      await fetch(`${API}/wagers/${m.id}/cancel`, { method: \"POST\" });\n      resetGame();\n    } catch (e) {\n      console.error(\"Cancel error:\", e);\n      alert(\"Cancel error:\\n\" + e.message);\n    }\n  }\n\n  // Typing handler with anti-paste and cps cap\n  function handleInput(e) {\n    if (isInputDisabled) return;\n    if (e.type === \"paste\") {\n      e.preventDefault();\n      return;\n    }\n    const val = e.target.value;\n    if (!sentence.startsWith(val)) {\n      setHasError(true);\n      return;\n    }\n    setHasError(false);\n\n    const now = Date.now();\n    const raw = Math.min(1, val.length / sentence.length);\n    const delta = raw - lastProg;\n    const dt = (now - lastProgTime) / 1000;\n    const cps = dt > 0 ? (delta * sentence.length) / dt : 0;\n    if (cps > MAX_CPS) return;\n\n    setLastProg(raw);\n    setLastProgTime(now);\n    setInputValue(val);\n    setPlayerProgress(raw);\n\n    if (currentMatch?.id) {\n      socket.emit(\"progress\", {\n        matchId: currentMatch.id,\n        wallet: walletAddress,\n        progress: raw,\n      });\n    }\n\n    if (val === sentence && currentMatch?.id) {\n      fetch(`${API}/wagers/${currentMatch.id}/complete`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ winner: walletAddress }),\n      });\n      setMatchStatus(\"finished\");\n      setIsInputDisabled(true);\n      setRaceResult({ result: \"win\" });\n    }\n  }\n\n  // ────────────────────────────────────────────────\n  // Fullscreen Match Views (modals visually, but we take the whole screen)\n  const WaitingView = () =>\n    currentMatch && matchStatus === \"waiting\" ? (\n      <div className=\"match-screen\">\n        <div className=\"match-panel\">\n          <div className=\"panel-header\">\n            <h2>Match Lobby</h2>\n            <div className=\"pill\">{currentMatch.amount} SOL</div>\n          </div>\n          <div className=\"panel-grid\">\n            <div className=\"panel card\">\n              <h3>Match Info</h3>\n              <div className=\"kv\"><span>Match ID:</span><span>#{currentMatch.id.slice(0, 6)}</span></div>\n              <div className=\"kv\"><span>Creator:</span><span>{currentMatch.creator.slice(0, 6)}…</span></div>\n              <div className=\"kv\"><span>Status:</span><span className=\"ok\">Waiting for opponent</span></div>\n            </div>\n            <div className=\"panel card\">\n              <h3>Players</h3>\n              <div className=\"player-row you\">\n                <div className=\"dot\" />\n                <div className=\"who\">You</div>\n                <div className=\"addr\">{walletAddress.slice(0, 6)}…</div>\n              </div>\n              <div className=\"player-row\">\n                <div className=\"dot muted\" />\n                <div className=\"who muted\">Waiting for player…</div>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"panel-actions\">\n            <button\n              className=\"btn danger\"\n              onClick={() => cancelMatch(currentMatch)}\n              disabled={!CAN_CANCEL}\n            >\n              Cancel Match\n            </button>\n            {!CAN_CANCEL && (\n              <div className=\"muted small\">Cancel becomes available when the grace period ends.</div>\n            )}\n          </div>\n        </div>\n      </div>\n    ) : null;\n\n  const ReadyOrRacingView = () =>\n    currentMatch && (matchStatus === \"ready\" || matchStatus === \"racing\") ? (\n      <div className=\"match-screen\">\n        <div className=\"race-wrap\">\n          {matchStatus === \"ready\" ? (\n            <div className=\"start-count\">\n              <div className=\"big-ring\">\n                <div className=\"ring-inner\">{countdown}</div>\n              </div>\n              <div className=\"start-text\">Race Starting</div>\n              <div className=\"muted\">Get ready to type!</div>\n            </div>\n          ) : (\n            <>\n              <div className=\"sentence card mono\">{sentence}</div>\n              <input\n                ref={inputRef}\n                type=\"text\"\n                value={inputValue}\n                onChange={handleInput}\n                onPaste={handleInput}\n                placeholder=\"Start typing…\"\n                disabled={isInputDisabled}\n                autoFocus\n                className={`type-input mono ${hasError ? \"error\" : \"\"}`}\n              />\n              {hasError && (\n                <div className=\"error-note\">Mistake detected — correct it before continuing.</div>\n              )}\n\n              <div className=\"track\">\n                <div className=\"lane\">\n                  <div\n                    className=\"car player\"\n                    style={{ left: `calc(${playerProgress * 100}% - 28px)` }}\n                    aria-label=\"Your car\"\n                  >\n                    🚗\n                  </div>\n                </div>\n                <div className=\"lane\">\n                  <div\n                    className=\"car foe\"\n                    style={{ left: `calc(${opponentProgress * 100}% - 28px)` }}\n                    aria-label=\"Opponent car\"\n                  >\n                    🏎️\n                  </div>\n                </div>\n              </div>\n            </>\n          )}\n        </div>\n      </div>\n    ) : null;\n\n  const ResultsView = () =>\n    matchStatus === \"finished\" && currentMatch ? (\n      <div className=\"match-screen\">\n        <div className=\"results-card card\">\n          {raceResult?.result === \"win\" ? (\n            <>\n              <div className=\"result-emoji\">🏆</div>\n              <h2 className=\"result-title ok\">Victory!</h2>\n              <p className=\"muted\">Claim your prize of {currentMatch.amount} SOL</p>\n              <div className=\"actions\">\n                <button\n                  className=\"btn primary\"\n                  onClick={async () => {\n                    try {\n                      const ix = await buildResolveIxn(\n                        currentMatch.id,\n                        walletAddress\n                      );\n                      const tx = new Transaction().add(ix);\n                      await wallet.sendTransaction(tx, connection);\n                      resetGame();\n                    } catch (e) {\n                      console.error(\"Claim error:\", e);\n                      alert(\"Payout error:\\n\" + e.message);\n                    }\n                  }}\n                >\n                  Claim Winnings\n                </button>\n                <button className=\"btn outline\" onClick={resetGame}>\n                  Back to Home\n                </button>\n              </div>\n            </>\n          ) : (\n            <>\n              <div className=\"result-emoji\">❌</div>\n              <h2 className=\"result-title danger\">Defeat</h2>\n              <p className=\"muted\">Better luck next time.</p>\n              <div className=\"actions\">\n                <button className=\"btn outline\" onClick={resetGame}>\n                  Back to Home\n                </button>\n              </div>\n            </>\n          )}\n        </div>\n\n        <div className=\"chat card\">\n          <h3>Match Chat</h3>\n          <div className=\"chat-messages\">\n            {chatMessages.map((msg, i) => (\n              <p\n                key={i}\n                className={msg.sender === walletAddress ? \"self\" : \"other\"}\n              >\n                <strong>{msg.sender.slice(0, 6)}…:</strong> {msg.message}\n              </p>\n            ))}\n          </div>\n          <div className=\"chat-input\">\n            <input\n              value={chatInput}\n              onChange={(e) => setChatInput(e.target.value)}\n              onKeyDown={(e) =>\n                e.key === \"Enter\" &&\n                socket.emit(\"message\", {\n                  matchId: currentMatch.id,\n                  sender: walletAddress,\n                  message: chatInput,\n                }) &&\n                setChatInput(\"\")\n              }\n              placeholder=\"Type message…\"\n            />\n            <button\n              className=\"btn\"\n              disabled={!chatInput.trim()}\n              onClick={() => {\n                socket.emit(\"message\", {\n                  matchId: currentMatch.id,\n                  sender: walletAddress,\n                  message: chatInput,\n                });\n                setChatInput(\"\");\n              }}\n            >\n              Send\n            </button>\n          </div>\n        </div>\n      </div>\n    ) : null;\n  // ────────────────────────────────────────────────\n  // EXTRA HOMEPAGE SECTIONS\n  const HowItWorks = () => (\n    <section className=\"how-section\">\n      <h2>How It Works</h2>\n      <div className=\"how-grid\">\n        <div className=\"how-card\">\n          <div className=\"how-num\">1</div>\n          <h3>Create</h3>\n          <p>Pick a wager amount and open a match.</p>\n        </div>\n        <div className=\"how-card\">\n          <div className=\"how-num\">2</div>\n          <h3>Join</h3>\n          <p>Join an open match with your wallet.</p>\n        </div>\n        <div className=\"how-card\">\n          <div className=\"how-num\">3</div>\n          <h3>Race &amp; Win</h3>\n          <p>Type fastest to win the entire pot.</p>\n        </div>\n      </div>\n    </section>\n  );\n\n  const FAQ = () => {\n    const [open, setOpen] = useState(null);\n    const items = [\n      {\n        q: \"What is TypeRacer?\",\n        a: \"A realtime typing game on Solana. Create or join a match, race, and the winner takes the pot.\",\n      },\n      {\n        q: \"How are payouts handled?\",\n        a: \"When the server declares the winner, the on-chain program pays the winner instantly (minus fee).\",\n      },\n      {\n        q: \"Can I choose any wager?\",\n        a: \"Yes. Use the presets or type a custom SOL amount (must be > 0).\",\n      },\n    ];\n    return (\n      <section className=\"faq-section\">\n        <h2>FAQ</h2>\n        <div className=\"faq-list\">\n          {items.map((it, i) => (\n            <div\n              key={i}\n              className={`faq-item ${open === i ? \"open\" : \"\"}`}\n              onClick={() => setOpen(open === i ? null : i)}\n            >\n              <div className=\"faq-q\">{it.q}</div>\n              {open === i && <div className=\"faq-a\">{it.a}</div>}\n            </div>\n          ))}\n        </div>\n      </section>\n    );\n  };\n\n  // If we created a match but forgot to stamp the timer, start now\n  useEffect(() => {\n    if (currentMatch && matchStatus === \"waiting\" && !matchCreatedAt) {\n      setMatchCreatedAt(Date.now());\n    }\n  }, [currentMatch, matchStatus, matchCreatedAt]);\n\n  // ────────────────────────────────────────────────\n  // FINAL RETURN (homepage vs. full match views)\n  return (\n    <div className=\"app-shell\">\n      <header className=\"topbar\">\n        <div className=\"brand\">\n          <div className=\"dot\" />\n          <div className=\"brand-text\">\n            <div className=\"brand-title\">TypeRacer</div>\n            <div className=\"brand-sub\">Race to win SOL</div>\n          </div>\n        </div>\n\n        {connected ? (\n          <div className=\"wallet-pill\">\n            {walletAddress.slice(0, 6)}… ({walletBalance.toFixed(2)} SOL)\n          </div>\n        ) : (\n          <WalletMultiButton className=\"connect-btn\" />\n        )}\n      </header>\n\n      {/* HOMEPAGE (only when NOT in a match) */}\n      {(!currentMatch || matchStatus === \"waiting\") && !currentMatch && (\n        <>\n          {renderHome()}\n          <HowItWorks />\n          <FAQ />\n        </>\n      )}\n\n      {/* FULLSCREEN MATCH VIEWS */}\n      {WaitingView()}\n      {ReadyOrRacingView()}\n      {ResultsView()}\n    </div>\n  );\n}\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}